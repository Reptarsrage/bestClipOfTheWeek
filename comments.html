<!DOCTYPE html>
<html>
<!--
    Justin Robb
    4/20/15
    bestClipOfTheWeek
    Home page
-->


<head>
    <title>Best Clip of the Week - Commenters</title>
    <link rel="shortcut icon" href="/common/images/sm64.ico">

    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>

    <link type="text/css" rel="stylesheet" href="/Style/jquery-ui.min.css?v=0.2.2(beta)">
    <link type="text/css" rel="stylesheet" href="/Style/common.css?v=0.2.2(beta)">
    <link type="text/css" rel="stylesheet" href="/Style/comments.css?v=0.2.2(beta)">

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js?v=0.2.2(beta)"></script>

    <!-- check login -->
    <script>
        var urlParams;
        var match,
        pl = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
        query = window.location.search.substring(1);

        urlParams = {};
        while (match = search.exec(query))
            urlParams[decode(match[1])] = decode(match[2]);

        //check for token
        if (!urlParams['token'] || !urlParams['username'])
            window.location = "login.html?v=0.2.2(beta)";

        // authorize
        var username = urlParams['username'];
        var token = urlParams['token'];

        $.ajax({
            url: 'https://bestclipoftheweek-1xxoi1ew.rhcloud.com/',
            async: false,
            type: "GET",
            timeout: 5000,
            data: {
                username: username,
                token: token,
                authorize: 'authorize'
            },
            success: function (msg) {
                if (!msg) {
                    window.location = "login.html?v=0.2.2(beta)";
                }
                // msg.status
                // msg.responseText
                // msg. statusText
                if (msg.hasOwnProperty("status")) {
                    if (msg.status != 200)
                        window.location = "login.html?v=0.2.2(beta)";
                } 
            },
            error: function (reason) {
                window.location = "login.html?v=0.2.2(beta)";
            },
        });
    </script>

    <script type="text/javascript" src="/Scripts/jquery-ui.min.js?v=0.2.2(beta)"></script>
    <script type="text/javascript" src="/Scripts/tooltips.js?v=0.2.2(beta)"></script>
    <script type="text/javascript" src="/Scripts/header.js?v=0.2.2(beta)"></script>
    <script type="text/javascript" src="/Scripts/comments.js?v=0.2.2(beta)"></script>
    <script type="text/javascript" src="https://apis.google.com/js/client.js?v=0.2.2(beta)&onload=onJSClientLoad"></script>
</head>
<body>
    <!--DUPLICATED ACCROSS PAGES-->
    <div id="header">
        <div id='cssmenu'>
            <ul>
                <li><a id="a_index">Search Youtube</a></li>
                <li><a id="a_quick">Quick Search (no charts)</a></li>
                <li class='active'><a id="a_comments">Commenters</a></li>
                <li><a id="a_config">Configure search terms</a></li>
                <li><a id="a_about">About</a></li>
            </ul>
        </div>
    </div>

    <div id="body">
        <h1 id="message" class="section" hidden="hidden"></h1>
        <div id="userSpace" class="section">
            <h2>Choose a video: <img name="title" class="tooltip" src="/common/images/info.png" alt="?" /></h2>
            <input id="input_video" type="text" placeholder="Enter a YouTube video Url" />
            <button id="fetch">Fetch Results</button>
            <div id="recommended">
                <h3 id="h3_recommended">Recommended: <img name="recommended" class="tooltip" src="/common/images/info.png" alt="?" /></h3>
                <ol id="select_bestOfTheWeek">
                    <li class="loading">
                        <img class="loading-image" src="common/images/loading.gif" alt="Loading..." />
                    </li>
                    <li class='error'>Error retrieving recommended videos.</li>
                </ol>
            </div>
        </div>
        <div id="collapse" class="expanded">
            <img src="/common/images/arrow.png" />
        </div>

        <div id="results" class="section" hidden="hidden">
            <div class="section">
                <hr />
                <h2>Showing commenters for: <img name="stats" class="tooltip" src="/common/images/info.png" alt="?" /></h2>
                <div id="stats">
                    <h3 class='error'>Unable to find stats for your video. Make sure the url you have provided is valid and contains a valid video ID. (For example: https://www.youtube.com/watch?<b>v=1M5vGlvic_o</b>)</h3>
                    <div id="stats_group">
                        <div class="loading">
                            <img class="loading-image" src="common/images/loading.gif" alt="Loading..." />
                        </div>
                    </div>
                </div>
            </div>
            <div class="section">
                <hr />
                <h2>Commenters (<span id="h2_comments">0</span>):<img name="commenters" class="tooltip" src="/common/images/info.png" alt="?" /></h2>
                <label><input onclick="toggleVoters($('#checkbox_voters'), true)" type="checkbox" id="checkbox_voters" /><span>Show users who commented on this video</span></label>
                <h3 class='error'>Unable to find comments for your video.</h3>
                <ol hidden="hidden" id="voters">
                    <li class="error">No voters</li>
                </ol>
            </div>
    </div>

    <!--DUPLICATED ACCROSS PAGES-->
    <div id="footer">
        <div id="footer_overlay">
            <div id="foot_content">
                <span id="foot_credits">Website made by: <b id="foot_myname">Justin Robb</b></span><br />
                <span id="foot_contact_info"><a href="mailto:justinprobb@gmail.com">Contact me</a></span><br />
                <span id="foot_linked_in"><a href="https://www.linkedin.com/in/jurobb">Linkedin</a></span>
                <span id="foot_giy_hub"><a href="https://github.com/Reptarsrage">Github</a></span>
            </div>
        </div>
    </div>
</body>
</html>
